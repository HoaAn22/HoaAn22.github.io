<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Minesweeper</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f2f2;
    display:flex;
    justify-content:center;
    margin-top:30px;
}

.game{
    background:#fff;
    padding:20px;
    border-radius:8px;
    box-shadow:0 0 10px rgba(0,0,0,.2);
    position:relative;
}

h3{
    margin:0 0 10px;
    text-align:center;
}

.board{
    display:grid;
    grid-template-columns:repeat(10, 40px);
    gap:1px;
    background:#333;
    padding:4px;
}

.cell{
    width:40px;
    height:40px;
    background:#a0a0a0;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    font-weight:bold;
    font-size:18px;
    user-select:none;
}

.cell.open{
    background:#eee;
    cursor:default;
}

.cell.mine{
    background:#ffb3b3;
}

.cell.flag{
    color:red;
}

/* ===== M√ÄU THEO S·ªê ===== */
.n1{ color:#2e7d32; }      /* xanh l√° */
.n2{ color:#ef6c00; }      /* cam */
.n3{ color:#c62828; }      /* ƒë·ªè */
.n4{ color:#8e0000; }      /* ƒë·ªè ƒë·∫≠m */
.n5,.n6,.n7,.n8{
    color:#4a148c;         /* t√≠m c·∫£nh b√°o cao */
}

.control{
    margin-top:10px;
    display:flex;
    justify-content:space-between;
}

button{
    padding:6px 12px;
    cursor:pointer;
}

/* ===== BANNER ===== */
.banner{
    position:absolute;
    inset:0;
    background:rgba(0,0,0,.55);
    display:none;
    align-items:center;
    justify-content:center;
    border-radius:8px;
}

.banner-content{
    background:#fff;
    padding:25px 35px;
    border-radius:10px;
    text-align:center;
}

</style>
</head>

<body>
<div class="game">
    <h3>Minesweeper</h3>

    <div id="board" class="board"></div>

    <div class="control">
        <div style="transform: translateY(5px);">Mines: 10</div>
        <button onclick="newGame()">New</button>
    </div>

    <div id="banner" class="banner">
        <div class="banner-content">
            <h2 id="bannerText"></h2>
            <button onclick="newGame()">Ch∆°i l·∫°i</button>
        </div>
    </div>
</div>

<script>
const SIZE = 10;
const MINES = 10;
let board = [];
let revealed = 0;
let gameOver = false;

function newGame(){
    board=[];
    revealed=0;
    gameOver=false;
    document.getElementById("banner").style.display="none";
    createBoard();
    placeMines();
    calcNumbers();
    draw();
}

function createBoard(){
    for(let r=0;r<SIZE;r++){
        board[r]=[];
        for(let c=0;c<SIZE;c++)
            board[r][c]={mine:false,count:0,open:false,flag:false};
    }
}

function placeMines(){
    let placed=0;
    while(placed<MINES){
        let r=Math.random()*SIZE|0;
        let c=Math.random()*SIZE|0;
        if(!board[r][c].mine){
            board[r][c].mine=true;
            placed++;
        }
    }
}

function calcNumbers(){
    for(let r=0;r<SIZE;r++)
        for(let c=0;c<SIZE;c++){
            if(board[r][c].mine) continue;
            let n=0;
            for(let dr=-1;dr<=1;dr++)
                for(let dc=-1;dc<=1;dc++){
                    let nr=r+dr,nc=c+dc;
                    if(nr>=0&&nr<SIZE&&nc>=0&&nc<SIZE&&board[nr][nc].mine)
                        n++;
                }
            board[r][c].count=n;
        }
}

function draw(){
    const b=document.getElementById("board");
    b.innerHTML="";
    for(let r=0;r<SIZE;r++)
        for(let c=0;c<SIZE;c++){
            const d=document.createElement("div");
            d.className="cell";
            d.onclick=()=>openCell(r,c,d);
            d.oncontextmenu=e=>{e.preventDefault(); toggleFlag(r,c,d);}
            b.appendChild(d);
        }
}

function openCell(r,c,el){
    if(gameOver) return;
    const cell=board[r][c];
    if(cell.open||cell.flag) return;

    cell.open=true;
    el.classList.add("open");

    if(cell.mine){
        el.textContent="üí£";
        el.classList.add("mine");
        lose();
        return;
    }

    revealed++;
    if(cell.count>0){
        el.textContent=cell.count;
        el.classList.add("n"+cell.count);
    }else flood(r,c);

    if(revealed===SIZE*SIZE-MINES) win();
}

function flood(r,c){
    for(let dr=-1;dr<=1;dr++)
        for(let dc=-1;dc<=1;dc++){
            let nr=r+dr,nc=c+dc;
            if(nr>=0&&nr<SIZE&&nc>=0&&nc<SIZE){
                let idx=nr*SIZE+nc;
                let el=document.querySelectorAll(".cell")[idx];
                if(!board[nr][nc].open&&!board[nr][nc].mine)
                    openCell(nr,nc,el);
            }
        }
}

function toggleFlag(r,c,el){
    if(gameOver) return;
    if(board[r][c].open) return;
    board[r][c].flag=!board[r][c].flag;
    el.textContent=board[r][c].flag?"üö©":"";
}

function lose(){
    gameOver=true;
    revealMines();
    showBanner("üí• B·∫°n ƒë√£ tr√∫ng m√¨n!");
}

function win(){
    gameOver=true;
    showBanner("üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ chi·∫øn th·∫Øng!");
}

function revealMines(){
    const cells=document.querySelectorAll(".cell");
    for(let r=0;r<SIZE;r++)
        for(let c=0;c<SIZE;c++)
            if(board[r][c].mine){
                let i=r*SIZE+c;
                cells[i].textContent="üí£";
                cells[i].classList.add("mine");
            }
}

function showBanner(t){
    document.getElementById("bannerText").textContent=t;
    document.getElementById("banner").style.display="flex";
}

newGame();
</script>
</body>
</html>
